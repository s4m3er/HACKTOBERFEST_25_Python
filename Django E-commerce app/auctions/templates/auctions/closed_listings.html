{% extends "auctions/layout.html" %}

{% block body %}
<h2 class="mb-4">Closed Listings</h2>

{% if listings %}
<div class="row">
  {% for listing in listings %}
  <div class="col-md-4 mb-4">
    <div class="card h-100 shadow-sm border-warning">
      {% if listing.image_url %}
      <img src="{{ listing.image_url }}" class="card-img-top" alt="{{ listing.title }}">
      {% endif %}
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ listing.title }}</h5>
        <p class="text-muted mb-2">{{ listing.description|truncatechars:120 }}</p>
        <p class="mt-auto"><strong>Final Price:</strong> ${{ listing.current_price }}</p>
        {% if listing.category %}
        <p class="mb-1"><span class="badge badge-info">{{ listing.category.name }}</span></p>
        {% endif %}
        {% if listing.winner %}
        <div class="alert alert-success py-2 px-3 mb-2">
          <small><strong>Winner:</strong> {{ listing.winner.username }}</small>
        </div>
        {% else %}
        <div class="alert alert-secondary py-2 px-3 mb-2">
          <small>No bids placed</small>
        </div>
        {% endif %}
        <a href="{% url 'listing_detail' listing.id %}" class="btn btn-outline-secondary btn-block mt-2">View Details</a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
  <div class="alert alert-info">No closed listings yet.</div>
{% endif %}
{% endblock %}
